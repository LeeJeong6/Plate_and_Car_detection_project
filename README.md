# 차량 번호판 및 차량 탐색 알고리즘 개발

본 프로젝트는 2025.01~2025.06까지 진행한 국민대학교 AILAB의 학부연구생 프로젝트에 대한 소개 및 최종 결과를 담은 reposi입니다.

**YOLOv11n** 모델을 기반으로 차량 및 번호판을 탐지하고, 다양한 전처리 전략과 Tracking 알고리즘을 실험한 프로젝트입니다.

---

## 프로젝트 개요

- 원본 이미지만으로는 번호판 인식 성능이 낮은 문제가 있었습니다.
- 이를 개선하기 위해 다음과 같은 전략을 실험했습니다:
  - **이미지 4분할 후 번호판 탐지**
  - **차량을 먼저 탐지한 뒤**, 해당 영역 내에서 번호판 탐지
  - 다양한 **전처리 방식과 데이터 구성**을 통해 실험을 체계화함

---

## 데이터 전처리 폴더 구조

프로젝트에서는 실험 목적에 따라 다양한 방식으로 데이터를 전처리하여 아래와 같은 폴더 구조로 구성하였습니다:

### `processed_original`
- **설명**: 원본 이미지 그대로의 데이터셋으로 학습한 모델 및 학습,추론 코드입니다
- **용도**: baseline 모델 학습 및 성능 비교 기준.

---

### `processed_quarter`
- **설명**: 원본 이미지를 **4분할(quarter)** 하여 생성한 데이터셋으로 학습한 모델 및 학습,추론 코드입니다.
- **용도**: 번호판이 작게 나오는 경우 인식률 향상을 기대하며 사용.

---

### `processed_original_and_quarter`
- **설명**: `processed_original` + `processed_quarter` 데이터를 **합쳐 놓은 폴더**이며 두 데이터로 동시에 학습한 모델 및 학습,추론 코드입니다
- **용도**: 전체적인 성능 향상 및 일반화에 도움을 주기 위한 데이터 혼합 구성.

---

### `processed_carcrop`
- **설명**: 차량 탐지 모델을 통해 **차량만 잘라낸(cropped)** 이미지들로 학습한 모델 및 학습,추론 코드입니다
- **용도**: 차량 내부에 번호판이 포함되어 있는 경우, 후속 번호판 탐지 모델의 입력으로 사용.

---

### `processed_car_and_plate`
- **설명**: 차량 탐지 모델을 통해 **차량만 잘라낸(cropped)** 이미지들과 **cropped**이미지 내에서 번호판을 탐지하는 방법입니다 
- **용도**: 차량 탐지 → 번호판 탐지 과정을 하나의 흐름으로 묶어 학습하거나 평가하는 데 사용.

---

## 학습 방법
- 위 4가지 방법을 통해 학습했고 하이퍼파라미터는 각각 다르게 실험했습니다
- 공통적으로 epoch은 100이며 dataaugmentation도 YOLOv11n버전에 호환되는 여러 방법을 사용했습니다

## 정량/정성 분석 결과

> 정량분석.xlsx를 확인합니다
- **<번호판 탐지>**
- 결과는 4분할 모델이 가장 좋았으며 번호판 1432개를 찾아내며 150% 탐지력을 보였습니다.
- 라벨에 해당되는 데이터는 총 940개이며 라벨이 아니었던 번호판까지 합쳐서 1432개를 찾은 것 이므로 precision,recall,정량분석을 따로 진행했습니다
- precision:0.93
- recall:0.80
- F1:0.86
- 새로운 번호판을 탐지한 개수: 642개

- **<차량탐지 및 차량+번호판>**
- 차량탐지만 한 결과는 데이터의 수가 적긴 했지만 성능은 우수했습니다
- precision:0.97
- recall:0.98
- 탐지한 bbox개수: 786
- 차량만 탐지한 이미지를 crop해서 번호판을 탐색하면 더 좋은 성능이 나올 것 같다는 기대와는 달리 4분할 방법이 가장 좋았습니다
- 그 이유를 생각해보면 원본 이미지는 3840*2160으로 사이즈가 큰데 YOLO에 학습될때 resize가 됩니다. 근데 여기서 차량을 또 탐색하고 이미지를 resize한다면 학습된 이미지와는 매우 다른 크기의 이미지가 생겨났을 것이고, 이는 번호판 탐색 모델이 인식하기에는 너무 작은 크기입니다. 또한 화질도 많이 안좋습니다.  차량+번호판 결과는 아래와 같습니다
- precision:0.90
- recall:0.76
- 탐지한 bbox개수: 870
- 이는 4분할 모델보다 훨씬 성능이 떨어진 것을 확인가능합니다
---

## 최종 성능 모델

- **구성**: `YOLOv11n` + `4분할` + `Data Augmentation`
- **Augment 설정**:
  - `translate`: `0.3`
  - `flipid`: `0.3`
  - `hsv_h`: `0.3`
  - "best pt" 로 pt파일 올려놨습니다
**적용 배경**:
- 어두운 환경, 노이즈(예: 비 오는 날)에서 인식 성능이 낮은 문제를 개선하기 위함
- 특히 비 오는 날 트럭의 경우 객체 탐지율이 10%도 되지 않는 문제점이 있었음
---

## Tracking 시연

Tracking 결과는 아래 유튜브 링크에서 확인하실 수 있습니다:  
[YouTube](https://youtu.be/9UKN-NbdLuA?si=yel69RmXtsKeTHRt)

---

## Tracking 알고리즘

- Tracking 기법은 번호판처럼 작은 객체를 탐지하는 데 적합한 알고리즘을 설계했습니다.
- 자세한 코드 및 실습이 가능한 저장소는 아래에서 확인하실 수 있습니다:  
[GitHub Repository](https://github.com/LeeJeong6/plate_detection)

---

## 전체 디렉토리 구조

```bash
├── processed_original/                 
├── processed_quarter/                 
├── processed_original_and_quarter/     
├── processed_carcrop/                  
├── processed_car_and_plate/           
├── tracking                       
├── requirements.txt
└── README.md

**본 폴더에 연구실 자원인 이미지와 라벨 등은 포함하지 않고 올립니다**
